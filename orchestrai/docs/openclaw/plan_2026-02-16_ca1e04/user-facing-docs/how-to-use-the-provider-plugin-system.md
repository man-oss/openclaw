# How to Use the Provider Plugin System

OpenClaw's provider plugin system lets you connect to different AI services. This guide shows you how to manage these connections, configure your authentication, and troubleshoot common issues.

## Understanding Provider Plugins

Provider plugins are add-ons that enable OpenClaw to work with AI services like Anthropic Claude, OpenAI, and others. Each plugin handles the specific requirements for connecting to and authenticating with its respective service.

### What Plugins Do

- **Connect to AI Services**: Enable communication with different AI providers
- **Handle Authentication**: Manage API keys, tokens, and OAuth login flows
- **Provide Models**: Make AI models available for your conversations
- **Manage Credentials**: Store and secure your authentication information

### Checking Available Plugins

To see which plugins you have installed, use:
```
openclaw plugins list --json
```

This displays all loaded provider plugins and their current status.

## Configuring Provider Authentication

Before using any AI service, you need to authenticate with it. OpenClaw supports multiple authentication methods depending on the provider.

### Authentication Methods

Different providers support different ways to authenticate:

- **API Keys**: Direct access using a key from the provider's dashboard
- **OAuth**: Browser-based login with automatic credential management
- **Tokens**: Provider-specific authentication tokens
- **Setup Tokens**: Special tokens generated by provider CLI tools

### Adding Your First Provider

To add authentication for a provider:

```
openclaw models auth login
```

You'll be guided through:

1. **Select Provider**: Choose from available installed plugins
2. **Choose Auth Method**: Pick how you want to authenticate
3. **Complete Setup**: Follow provider-specific instructions

The system automatically detects what authentication methods each provider supports and only shows you valid options.

### Setting Up Anthropic Claude

For Anthropic Claude, you have two special options:

**Option 1: Using Claude CLI Setup Token**

If you've already run the Anthropic CLI:

```
openclaw models auth setup-token --provider anthropic
```

When prompted, paste the token from your `claude setup-token` command.

**Option 2: Adding Any Provider Token**

To manually add a token for any provider:

```
openclaw models auth add
```

Follow the prompts to:
- Select your provider or enter a custom provider ID
- Choose your token method
- Paste your authentication token
- Optionally set an expiration time

### Pasting Tokens Directly

If you already have a token and want to add it quickly:

```
openclaw models auth paste-token --provider <provider-name>
```

Optional parameters:
- `--profile-id <name>`: Use a custom profile name instead of the default
- `--expires-in <duration>`: Set when the token expires (e.g., "365d", "12h", "30m")

Example:
```
openclaw models auth paste-token --provider anthropic --expires-in 90d
```

## Managing Plugin Settings

### Auth Profiles

Each authentication setup creates an "auth profile" - a named configuration that stores your credentials securely.

**Default Profile Names**: When you authenticate, the system creates a profile with a standard name format: `<provider>:manual` (e.g., `anthropic:manual`).

**Custom Profiles**: You can create multiple profiles for the same provider with different credentials by specifying a custom profile ID.

### Setting Default Models

When authenticating, you can automatically set a default model for conversations:

```
openclaw models auth login --set-default
```

This configures the system to use the provider's recommended model by default. Without this flag, the model becomes available but won't be automatically selected.

### Provider-Specific Options

Some providers require additional configuration during setup. The interactive login process will prompt you for any provider-specific settings and save them to your configuration file automatically.

## Working with Multiple Providers

You can authenticate with multiple providers simultaneously. Each provider maintains its own auth profile and settings.

### Switching Between Providers

Once you've configured multiple providers:

1. Each provider's models become available in your model selection
2. Your credentials are managed separately per provider
3. You can authenticate to the same provider using different methods (API key and OAuth, for example)

### Provider Selection

To authenticate with a specific provider without interactive prompts:

```
openclaw models auth login --provider <provider-id> --method <method-id>
```

This skips the provider selection menu and goes directly to the authentication flow.

## Troubleshooting Plugin Issues

### "No provider plugins found" Error

This means no provider plugins are installed. Install at least one provider plugin:

```
openclaw plugins install
```

### "Unknown provider" Error

The provider you specified isn't loaded. This happens when:

- The provider plugin isn't installed
- You misspelled the provider ID
- The plugin failed to load

Check available providers with `openclaw plugins list --json` and verify your provider name matches exactly.

### Invalid Configuration

If you see configuration validation errors:

1. The error message shows which configuration file has issues
2. Each issue lists the specific path and problem
3. Fix the indicated problems in your configuration file
4. Run the authentication command again

### Token Validation Failures

When pasting tokens:

- **Anthropic setup tokens**: Must match the expected format from the Claude CLI
- **Custom tokens**: Must not be empty or contain only whitespace
- **Expired tokens**: If you set an expiration, the token won't work after that time

### Interactive TTY Required

Authentication commands require an interactive terminal. If you see "requires an interactive TTY":

- Run the command from a regular terminal, not in a script
- Don't pipe input or redirect output during authentication
- Ensure your terminal supports interactive prompts

### Remote Environment Considerations

The system automatically detects if you're running in a remote environment (like SSH or cloud shell) and adjusts authentication flows accordingly. OAuth flows may work differently in remote environments to ensure you can complete authentication successfully.

## Basic Plugin Customization

### Profile Naming

Customize auth profile names to organize multiple credentials:

```
openclaw models auth paste-token --provider myservice --profile-id myservice:production
```

This helps when you have:
- Development and production credentials
- Multiple accounts with the same provider
- Different permission levels

### Token Expiration

Set token expiration to match your provider's token lifetime:

```
openclaw models auth add
```

When prompted about expiration:
- Choose "yes" if your token has a limited lifetime
- Enter duration in natural format: "365d" (days), "12h" (hours), "30m" (minutes)
- The system tracks expiration and can warn when tokens need renewal

### Configuration Updates

After any authentication setup, the system:

1. Saves credentials securely in auth profiles
2. Updates your configuration file with the new provider settings
3. Displays confirmation with profile details
4. Shows any provider-specific notes or next steps

All changes are logged so you can verify what was configured.

## Best Practices

### Security
- Never share auth profile files - they contain your credentials
- Use token expiration for enhanced security
- Create separate profiles for different security contexts

### Organization
- Use descriptive profile IDs when managing multiple accounts
- Set default models for your most common use case
- Keep provider documentation links handy (shown during provider selection)

### Maintenance
- Check for plugin updates regularly
- Review and remove unused auth profiles
- Monitor token expiration dates for tokens with limited lifetimes

### Getting Help
- Provider-specific documentation links appear during setup
- Provider notes display after successful authentication
- Error messages include specific file paths and configuration issues